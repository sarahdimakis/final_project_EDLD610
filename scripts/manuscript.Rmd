---
title             : "Personality and political beliefs across the lifespan"
shorttitle        : "PERSONALITY AND POLITICAL BELIEFS"
author: 
  - name          : "Sarah Dimakis"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "University of Oregon, Eugene, OR"
    email         : "sdimakis@uoregon.edu"
  - name          : "Meghan Siritzky"
    affiliation   : "1"
  - name          : "Jamie Yellowtail"
    affiliation   : "1"
affiliation:
  - id            : "1"
    institution   : "University of Oregon"
authornote: |
  This project was completed as part of the EDLD Introduction to Data Science class at the University of Oregon.
abstract: |
  Here is where we will write our abstract.
  
keywords          : "keywords"
wordcount         : "X"
bibliography      : ["r-references.bib"]
floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no
documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
library(papaja)
library(rio)
library(here)
library(tidyverse)
library(psych)
library(knitr)
library(MBESS)
library(viridis)

data <- import(here("data", "EPB.sav"), setclass = "tbl_df")
```

```{r analysis-preferences}
knitr::opts_chunk$set(echo = FALSE)

```

```{r filter}
#Removing particpants from the sample

#filter out preview mode (not real participants) and those who did not complete the survey
data <- data %>% 
  filter(DistributionChannel != "preview" & Progress == 100)

#filter out those who did not pass the attention checks
data <- data %>% 
  filter(Q6_8 == 6 & Q5_14 == 3)

#filter out those who took the survey too quickly (the time cut offs were predetermined and based on which condition the participant was randomly assigned to)
data <- data %>% 
  pivot_longer(cols = Video_DO_V4:Video_DO_V1, 
               names_to = "Video_DO", 
               values_to = "Value",
               names_prefix = "Video_DO_",
               values_drop_na = TRUE) %>% 
  filter(Video_DO == 'V1' & Duration__in_seconds_ >316 | 
           Video_DO == 'V2' & Duration__in_seconds_ > 340 | 
           Video_DO == 'V3' & Duration__in_seconds_ > 398 |
           Video_DO == 'V4' & Duration__in_seconds_ > 666 | 
           Video_DO == 'V5' & Duration__in_seconds_ > 565 | 
           Video_DO == 'V6' & Duration__in_seconds_ > 538) %>% 
  filter(Duration__in_seconds_ < 5000) #this person spent too long taking the survey
```

```{r aggregrateSEC}

#Aggregating the social and economic conservationism scale (SECs) using scoreItems from the psych package and mutate from dplyr
items <- c("Q3_1", "Q3_2","Q3_3","Q3_4","Q3_5","Q3_6","Q3_7","Q3_8","Q3_9","Q3_10","Q3_11","Q3_12" )

#econonmic conservatism subscale 
scaleKey <- c(0, 1, 0, 0, -1, 1, 0, 0, 1, 1, 0, 0)
economic <- scoreItems(keys = scaleKey, items = data[items], 
  totals = FALSE, missing = FALSE, min = 0, max = 100)
data <- data %>% 
  mutate(SEC_economic_conservatism = economic$scores[,1])

#social conservatism subscale
scaleKey <- c(-1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1)
social <- scoreItems(keys = scaleKey, items = data[items], 
  totals = FALSE, missing = FALSE, min = 0, max = 100)
data <- data %>% 
  mutate(SEC_social_conservatism = social$scores[,1])
```

```{r aggregateTIPI}

#Aggregating big 5 traits (TIPI) using scoreItems from the psych package and mutate from dplyr
items <- c("Q4_1", "Q4_2", "Q4_3", "Q4_4", "Q4_5", "Q4_6", "Q4_7", "Q4_8", "Q4_9", "Q4_10")

#Extraversion
scaleKey <- c(1, 0, 0, 0, 0, -1, 0, 0, 0, 0)
extraversion <- scoreItems(keys = scaleKey, items = data[items], 
  totals = FALSE, missing = FALSE, min = 1, max = 7)
data <- data %>% 
  mutate(Extraversion = extraversion$scores[,1])

#Agreeableness
scaleKey <- c(0, -1, 0, 0, 0, 0, 1, 0, 0, 0)
agree <- scoreItems(keys = scaleKey, items = data[items], 
  totals = FALSE, missing = FALSE, min = 1, max = 7)
data <- data %>% 
  mutate(Agreeableness = agree$scores[,1])

#Conscientiousness
scaleKey <- c(0, 0, 1, 0, 0, 0, 0, -1, 0, 0)
consc <- scoreItems(keys = scaleKey, items = data[items], 
  totals = FALSE, missing = FALSE, min = 1, max = 7)
data <- data %>% mutate(Conscientiousness = consc$scores[,1])

#Emotional stability
scaleKey <- c(0, 0, 0, -1, 0, 0, 0, 0, 1, 0)
emo <- scoreItems(keys = scaleKey, items = data[items], 
  totals = FALSE, missing = FALSE, min = 1, max = 7)
data <- data %>% 
  mutate(Emotional_stability = emo$scores[,1])

#Openness to experiences
scaleKey <- c(0, 0, 0, 0, 5, 0, 0, 0, 0, -1)
open <- scoreItems(keys = scaleKey, items = data[items], 
  totals = FALSE, missing = FALSE, min = 1, max = 7)
data <- data %>% 
  mutate(Openness_to_experiences = open$scores[,1])
```

```{r select}
#selecting the variables that we want to use, cleaning, and characterizing dataset
data <- data %>% 
  select(ResponseId, Q7, Q8, Q9, Q10, Q11,
         SEC_economic_conservatism, SEC_social_conservatism,
         Agreeableness, Conscientiousness, Openness_to_experiences, Extraversion, Emotional_stability) %>% 
  rename(Gender = Q7, 
         Age = Q8, 
         Ethnicity = Q9, 
         Political_orientation = Q10,
         Political_affiliation = Q11,
         id = ResponseId) %>% 
  janitor::clean_names() %>% 
  characterize() %>% 
  mutate(age = as.numeric(age))
```

```{r tidying}
#last step is to tidy our data
tidy <- data %>% 
  pivot_longer(cols = c(sec_economic_conservatism, sec_social_conservatism),
               names_to = "conservatism_type",
               names_prefix = "sec_",
               values_to = "conservatism_score") %>% 
  mutate(conservatism_type = recode(conservatism_type, `economic_conservatism` = "Economic conservatism",
                                    `social_conservatism` = "Social conservatism")) %>%
  pivot_longer(cols = agreeableness:emotional_stability,
               names_to = "personality_trait",
               values_to = "personality_score") %>% 
  mutate(personality_trait = recode(personality_trait, `agreeableness` = "Agreeableness",
                                    `conscientiousness` = "Conscientiousness",
                                    `openness_to_experiences` = "Openness to experiences",
                                    `extraversion` = "Extraversion",
                                    `emotional_stability` = "Emotional stability"))
```

```{r table1, echo = FALSE, results = "asis"}
tidy_table_sc <- tidy %>% 
  filter(conservatism_type == 'Social conservatism') %>% 
  mutate(conservatism_score = case_when(       
      conservatism_score <= 19 & conservatism_score >= 0 ~ "[0-19]",
      conservatism_score <= 39 & conservatism_score >= 20 ~ "[20-39]",
      conservatism_score <= 59 & conservatism_score >= 40 ~ "[40-59]",
      conservatism_score <= 79 & conservatism_score >= 60 ~ "[60-79]",
      TRUE ~ "[80-100]"))
tidy_table_sc <- tidy_table_sc %>% 
  group_by(personality_trait, conservatism_score) %>% 
  summarize(mean_personality_score = mean(personality_score)) %>% 
  pivot_wider(names_from = conservatism_score, values_from = mean_personality_score)

apa_table(tidy_table_sc, 
            caption = "Mean Personality Trait Scores by Social Conservatism Score",
          col_spanners = list(`Social Conservatism Score` = c(2, 6)),
          note = "Personality trait scores reported on a 1-7 scale.")
```

```{r table2, echo = FALSE, results = "asis"}
tidy_table_ec <- tidy %>% 
  filter(conservatism_type == 'Economic conservatism') %>% 
  mutate(conservatism_score = case_when(       
      conservatism_score <= 19 & conservatism_score >= 0 ~ "[0-19]",
      conservatism_score <= 39 & conservatism_score >= 20 ~ "[20-39]",
      conservatism_score <= 59 & conservatism_score >= 40 ~ "[40-59]",
      conservatism_score <= 79 & conservatism_score >= 60 ~ "[60-79]",
      TRUE ~ "[80-100]"))
tidy_table_ec <- tidy_table_ec %>% 
  group_by(personality_trait, conservatism_score) %>% 
  summarize(mean_personality_score = mean(personality_score)) %>% 
  pivot_wider(names_from = conservatism_score, values_from = mean_personality_score)

apa_table(tidy_table_ec, 
            caption = "Mean Personality Trait Scores by Economic Conservatism Score",
          col_spanners = list(`Economic Conservatism Score` = c(2, 6)),
          note = "Personality trait scores reported on a 1-7 scale.")
```

```{r linearmodels_conservatism_ocean, include = FALSE}
untidy <- tidy %>% 
  pivot_wider(names_from = conservatism_type, values_from = conservatism_score) %>% 
  pivot_wider(names_from = personality_trait, values_from = personality_score) %>% 
  rename(social_conservatism = 'Social conservatism',
         economic_conservatism = 'Economic conservatism',
         openness_to_experiences = 'Openness to experiences',
         emotional_stability = 'Emotional stability')

sc_ocean <- lm(social_conservatism ~ openness_to_experiences + Conscientiousness + Extraversion + Agreeableness + emotional_stability,
              data = untidy)
summary(sc_ocean)
plot(scale(residuals(sc_ocean)) ~ scale(fitted(sc_ocean)), xlab="Social Conservatism Scores", ylab = "Scaled Residuals")

ec_ocean <- lm(economic_conservatism ~ openness_to_experiences + Conscientiousness + Extraversion + Agreeableness + emotional_stability,
              data = untidy)
summary(ec_ocean)
plot(scale(residuals(ec_ocean)) ~ scale(fitted(ec_ocean)), xlab="Economic Conservatism Scores", ylab = "Scaled Residuals")
```

```{r linearmodels_conservatism_ocean_tables, echo = FALSE, results = "asis"}
apa_sc_ocean <- apa_print(sc_ocean)
apa_sc_ocean$table %>% 
  apa_table(caption = "Regression Table Predicting Social Conservatism From Big-Five Personality Traits.", note = "Residual standard error: 25.13 on 125 degrees of freedom.
Multiple R-squared: 0.168, Adjusted R-squared: 0.135. F(5, 125): 5.051, p-value: 0.0003.", escape = FALSE)

apa_ec_ocean <- apa_print(ec_ocean)
apa_ec_ocean$table %>% 
  apa_table(caption = "Regression Table Predicting Economic Conservatism From Big-Five Personality Traits.", note = "Residual standard error: 21.3 on 125 degrees of freedom. Multiple R-squared: 0.081, Adjusted R-squared: 0.044. F(5, 125): 2.207, p-value: 0.058.", escape = FALSE)
```


# Methods

## Participants

## Material

## Procedure

## Data analysis
We used `r cite_r("r-references.bib")` for all our analyses.


# Results

In order to understand the relation between conservatism and personality, we first looked at Big Five personality trait (Openness to Experience, Conscientiousness, Extraversion, Agreeableness, and Emotional Stability) scores across the spectrum of Social Conservatism (Table 1) and Economic Conservatism (Table 2) scores.

To see whether there were significant relations between Social Conservatism and the Big Five, we then ran a multiple regression predicting Social Conservatism from the Big Five personality traits. A significant regression equation was found (*F*(5, 125) = 5.051, *p* < .001), with an adjusted $R^2$ of 0.135 (Table 2). Thus, personality traits taken together explained 13.48% of variance in Social Conservatism scores. Participants' predicted Social Conservatism scores were equal to 25.82 - 3.73(Openness to Experience) + 0.07(Conscientiousness) + 1.56(Extraversion) + 3.93(Agreeableness) + 4.30(Emotional Stability). Agreeableness and Emotional Stability were significant predictors of Social Conservatism.

To see whether there were significant relations between Economic Conservatism and the Big Five, we then ran a multiple regression predicting Economic Conservatism from the Big Five personality traits. No significant regression equation was found (*F*(5, 125) = 2.207, *p* = .058) (Table 3). Thus, personality traits taken together did not significantly explain variance in Economic Conservatism scores. However, Openness to Experience was a significant predictor of Economic Conservatism. 

To better understand the relation between social and economic conservatism, we examined the correlation between social and economic conservatism scores, and found it to be r = 0.65. Neither social nor economic extraversion were strongly correlated with any of the Big Five personality traits.

# Discussion


\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>

```{r correlations, echo = FALSE, results = "asis"}
set.seed=180
cor_conservatism <- corr.test(untidy$economic_conservatism, untidy$social_conservatism)
cor_conservatism

untidy_cor <- untidy %>% 
  select(-c(1:6)) %>% 
  rename('Social conservatism' = 'social_conservatism',
         'Economic conservatism' = 'economic_conservatism',
         'Openness to experiences' = 'openness_to_experiences',
         'Emotional stability' = 'emotional_stability')
cor_conservatism_ocean <- round(cor(untidy_cor),2)
upper_s<-cor_conservatism_ocean
upper_s[upper.tri(cor_conservatism_ocean)]<-""
upper_s<-as.data.frame(upper_s) %>%
  apa_table(
    caption = "Correlation Matrix for Conservatism and Big Five Personality Traits",
  landscape = TRUE,
  font_size = "tiny")

heatmap(cor_conservatism_ocean,
        Rowv = NA,
        Colv = NA,
        main = "Correlation Heatmap",
        margins = c(15,15),
        col = viridis(100, direction = -1))
```

```{r figure1, fig.cap= ""}
ggplot(tidy, aes(x = personality_score, y = conservatism_score, color = personality_trait)) +
  geom_smooth(se=FALSE, method = "lm")+
  labs(title = "Conservatism by Personality Traits", subtitle = "Big 5 traits self-reported by adults aged 20-68",
       x= "How strongly participants identify with the personality trait", y = "Conservatism", 
       color = "Personality Trait")+
  theme_minimal()+
  scale_color_viridis_d() +
  facet_wrap(~conservatism_type)
```

```

\endgroup
